---
export const prerender = true;
import BaseLayout from "@layouts/BaseLayout.astro";
import { services, getRelatedServices } from "@data/services";
import { getPromotionsForLocation } from "@data/promotions";

import ResponsiveImage from "@components/ui/ResponsiveImage.astro";

import ProcessSteps from "@components/sections/ProcessSteps.astro";
import ServicesGrid from "@components/sections/ServicesGrid.astro";
import ReviewsCarousel from "@components/sections/ReviewsCarousel.astro";
import FAQSection from "@components/sections/FAQSection.astro";
import FinalCTA from "@components/sections/FinalCTA.astro";
import Header from "@components/layout/Header.astro";
import Footer from "@components/layout/Footer.astro";
import Breadcrumbs from "@components/ui/Breadcrumbs.astro";
import Button from "@components/ui/Button.astro";
import { siteConfig } from "@config/site.config";

export async function getStaticPaths() {
    return services.map((service) => ({
        params: { slug: service.slug },
        props: { service },
    }));
}

const { service } = Astro.props;
const relatedServices = getRelatedServices(service.id);
const promotions = getPromotionsForLocation("service-page", service.slug);

import { generateFAQSchema } from "@utils/schema";

// Schema Markup
const serviceSchema = {
    "@context": "https://schema.org",
    "@type": "Service",
    name: service.title,
    description: service.metaDescription,
    provider: {
        "@type": "LocalBusiness",
        name: "Ez2Fix Garage Doors",
        image: "https://ez2fixllc.com/images/logo.png",
        // SAB-compliant: no street address
        telephone: "+12015546769",
        priceRange: service.priceRange || "$$",
    },
    areaServed: {
        "@type": "State",
        name: "New Jersey",
    },
    hasOfferCatalog: {
        "@type": "OfferCatalog",
        name: "Garage Door Services",
        itemListElement: [
            {
                "@type": "Offer",
                itemOffered: {
                    "@type": "Service",
                    name: service.title,
                },
            },
        ],
    },
};

const faqSchema = service.faqs ? generateFAQSchema(service.faqs) : null;
const allSchema = [serviceSchema, faqSchema].filter(Boolean) as object[];
---

<BaseLayout
    title={service.metaTitle}
    description={service.metaDescription}
    schema={allSchema}
>
    <Header />

    <!-- Hero Section -->
    <section
        class="relative bg-dark-900 text-cream-100 py-12 lg:py-20 overflow-hidden mt-20"
        style="background-color: #0D0A06; color: #FFF8E1;"
    >
        <div class="absolute inset-0 z-0">
            <ResponsiveImage
                src={service.heroBanner || service.heroImage}
                alt={service.title}
                width={1920}
                height={1080}
                class="w-full h-full object-cover"
                loading="eager"
                fetchpriority="high"
            />
            <div
                class="absolute inset-0 bg-gradient-to-r from-dark-900 via-dark-900/75 to-dark-900/40"
            >
            </div>
        </div>

        <div class="container mx-auto px-4 relative z-10">
            <Breadcrumbs
                items={[
                    { name: "Services", url: "/services" },
                    { name: service.title },
                ]}
                className="mb-6 text-cream-200"
            />
            <div class="max-w-3xl">
                {
                    service.emergency && (
                        <div class="inline-flex items-center bg-red-600/90 text-white px-4 py-1.5 rounded-full mb-6 font-bold text-sm uppercase tracking-wide shadow-lg animate-pulse backdrop-blur-sm">
                            <svg class="w-4 h-4 mr-2">
                                <path
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="1.5"
                                    d="m3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75L12 13.5z"
                                />
                            </svg>
                            24/7 Emergency Service
                        </div>
                    )
                }

                <h1
                    class="text-4xl md:text-6xl font-bold mb-6 leading-tight text-cream-100"
                >
                    {service.heroTitle || service.title}
                </h1>
                <p
                    class="text-xl text-cream-200 mb-8 leading-relaxed max-w-2xl"
                >
                    {service.heroSubtitle || service.shortDescription}
                </p>

                <div class="flex flex-col sm:flex-row gap-4">
                    <a
                        href="/booking?utm_source=website&utm_medium=cta&utm_campaign=service-page"
                        class="inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-dark-900 bg-gold-500 rounded-lg hover:bg-gold-400 hover:text-white transition-all transform hover:scale-105 shadow-lg shadow-gold-500/20"
                    >
                        <svg class="w-5 h-5 mr-2"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"
                            ></path></svg
                        >
                        Get Free Estimate
                    </a>
                    <a
                        href="tel:2015546769"
                        class="inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-white border-2 border-white/20 bg-white/5 rounded-lg hover:bg-white hover:text-dark-900 transition-all backdrop-blur-sm"
                    >
                        <svg class="w-5 h-5 mr-2"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.04 12.04 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5z"
                            ></path></svg
                        >
                        Call (201) 554-6769
                    </a>
                </div>

                <div
                    class="mt-10 flex flex-wrap gap-6 text-sm font-medium text-gray-400"
                >
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-gold-500 mr-2"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M9 12.75L11.25 15L15 9.75M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0"
                            ></path></svg
                        >
                        Licensed & Insured
                    </div>
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-gold-500 mr-2"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M9 12.75L11.25 15L15 9.75M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0"
                            ></path></svg
                        >
                        10-Year Warranty
                    </div>
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-gold-500 mr-2"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M9 12.75L11.25 15L15 9.75M21 12a9 9 0 1 1-18 0a9 9 0 0 1 18 0"
                            ></path></svg
                        >
                        5-Star Rated
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Symptoms Section - "Signs You Need This Service" -->
    {
        service.symptoms && service.symptoms.length > 0 && (
            <section class="py-16 bg-cream-100 border-b border-cream-200">
                <div class="container mx-auto px-4">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-2xl md:text-3xl font-bold text-dark-900 mb-8 text-center">
                            Signs You Need {service.title}
                        </h2>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                            {service.symptoms.map((symptom) => (
                                <div class="bg-white p-4 rounded-lg shadow-sm border border-gray-100 flex items-start">
                                    <svg class="w-6 h-6 text-red-500 mr-3 flex-shrink-0 mt-0.5">
                                        <path
                                            fill="none"
                                            stroke="currentColor"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="1.5"
                                            d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0zM12 15.75h.007v.008H12z"
                                        />
                                    </svg>
                                    <span class="font-medium text-dark-800">
                                        {symptom}
                                    </span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            </section>
        )
    }

    <!-- Overview Section -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-12 items-start">
                <div>
                    <h2
                        class="text-3xl md:text-4xl font-bold text-dark-900 mb-6"
                    >
                        About This Service
                    </h2>
                    <p class="text-lg text-dark-600 mb-8 leading-relaxed">
                        {service.overview}
                    </p>

                    <div
                        class="bg-gray-50 p-8 rounded-xl border border-gray-100 shadow-sm"
                    >
                        <h3
                            class="text-xl font-bold text-dark-800 mb-6 flex items-center"
                        >
                            <svg class="w-6 h-6 text-gold-500 mr-2"
                                ><path
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                    stroke-width="1.5"
                                    d="M9 12.75L11.25 15L15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.75 3.75 0 0 1-1.043 3.296a3.75 3.75 0 0 1-3.296 1.043A3.75 3.75 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.75 3.75 0 0 1-3.296-1.043a3.75 3.75 0 0 1-1.043-3.296A3.75 3.75 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.75 3.75 0 0 1 1.043-3.296a3.75 3.75 0 0 1 3.296-1.043A3.75 3.75 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.75 3.75 0 0 1 3.296 1.043a3.75 3.75 0 0 1 1.043 3.296A3.75 3.75 0 0 1 21 12"
                                ></path></svg
                            >
                            Why Choose Us?
                        </h3>
                        <ul class="space-y-4">
                            {
                                service.benefits.map((benefit) => (
                                    <li class="flex items-start">
                                        <svg class="w-5 h-5 text-gold-500 mr-3 flex-shrink-0 mt-1">
                                            <path
                                                fill="none"
                                                stroke="currentColor"
                                                stroke-linecap="round"
                                                stroke-linejoin="round"
                                                stroke-width="1.5"
                                                d="m4.5 12.75l6 6l9-13.5"
                                            />
                                        </svg>
                                        <span class="text-dark-700 font-medium">
                                            {benefit}
                                        </span>
                                    </li>
                                ))
                            }
                        </ul>
                    </div>

                    <!-- Promotions Display -->
                    {
                        promotions.length > 0 && (
                            <div class="mt-8 space-y-4">
                                {promotions.map((promo) => (
                                    <div
                                        class={`p-6 rounded-xl border-l-4 shadow-md ${promo.variant === "gold" ? "bg-gold-50 border-gold-500" : "bg-gray-50 border-gray-500"}`}
                                    >
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <div class="font-bold text-xl text-dark-900 mb-2">
                                                    {promo.title}
                                                </div>
                                                <div class="text-dark-600">
                                                    {promo.description}
                                                </div>
                                            </div>
                                            <div
                                                class={`ml-4 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${promo.variant === "gold" ? "bg-gold-500 text-dark-900" : "bg-dark-700 text-white"}`}
                                            >
                                                {promo.badgeText}
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )
                    }
                </div>

                <div class="relative sticky top-24">
                    <ResponsiveImage
                        src={service.heroImage}
                        alt={service.title}
                        width={800}
                        height={600}
                        class="rounded-2xl shadow-2xl w-full h-auto object-cover aspect-[4/3]"
                    />
                    {/* Trust Badge Overlay */}
                    <div
                        class="absolute -bottom-6 -left-6 bg-white p-6 rounded-xl shadow-xl hidden lg:block border border-gray-100"
                    >
                        <div class="flex items-center space-x-2 mb-1">
                            <div class="text-gold-500 font-bold text-3xl">
                                5.0
                            </div>
                            <div class="flex text-gold-500">
                                <svg class="w-5 h-5"
                                    ><path
                                        fill="currentColor"
                                        fill-rule="evenodd"
                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                        clip-rule="evenodd"></path></svg
                                >
                                <svg class="w-5 h-5"
                                    ><path
                                        fill="currentColor"
                                        fill-rule="evenodd"
                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                        clip-rule="evenodd"></path></svg
                                >
                                <svg class="w-5 h-5"
                                    ><path
                                        fill="currentColor"
                                        fill-rule="evenodd"
                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                        clip-rule="evenodd"></path></svg
                                >
                                <svg class="w-5 h-5"
                                    ><path
                                        fill="currentColor"
                                        fill-rule="evenodd"
                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                        clip-rule="evenodd"></path></svg
                                >
                                <svg class="w-5 h-5"
                                    ><path
                                        fill="currentColor"
                                        fill-rule="evenodd"
                                        d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                        clip-rule="evenodd"></path></svg
                                >
                            </div>
                        </div>
                        <div class="text-sm text-gray-500 font-medium">
                            Based on {siteConfig.trustSignals.reviewCount} 5-Star
                            Reviews
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Process Steps -->
    {
        service.processSteps && service.processSteps.length > 0 && (
            <ProcessSteps steps={service.processSteps} />
        )
    }

    <!-- FAQs -->
    {
        service.faqs && service.faqs.length > 0 && (
            <FAQSection faqs={service.faqs} />
        )
    }

    <!-- Trust Section -->
    <section class="py-16 bg-cream-100">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center mb-12">
                <h2 class="text-3xl font-bold text-dark-700 mb-4">
                    Why Choose Ez2Fix?
                </h2>
                <p class="text-lg text-dark-600">
                    We're committed to providing premium quality service and
                    parts.
                </p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                    <div
                        class="w-12 h-12 bg-gold-100 text-gold-600 rounded-full flex items-center justify-center mx-auto mb-4"
                    >
                        <svg class="w-6 h-6"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M9 12.75L11.25 15L15 9.75m-3-7.036A11.96 11.96 0 0 1 3.598 6A12 12 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623c5.176-1.332 9-6.03 9-11.622c0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285"
                            ></path></svg
                        >
                    </div>
                    <h3 class="font-bold text-dark-800 mb-2">
                        Licensed & Insured
                    </h3>
                    <p class="text-sm text-dark-600">
                        Fully licensed (#13VH13553300) and insured for your
                        protection.
                    </p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                    <div
                        class="w-12 h-12 bg-gold-100 text-gold-600 rounded-full flex items-center justify-center mx-auto mb-4"
                    >
                        <svg class="w-6 h-6"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="m3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75L12 13.5z"
                            ></path></svg
                        >
                    </div>
                    <h3 class="font-bold text-dark-800 mb-2">
                        Same-Day Service
                    </h3>
                    <p class="text-sm text-dark-600">
                        We arrive quickly with fully stocked trucks to fix it in
                        one visit.
                    </p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                    <div
                        class="w-12 h-12 bg-gold-100 text-gold-600 rounded-full flex items-center justify-center mx-auto mb-4"
                    >
                        <svg class="w-6 h-6"
                            ><path
                                fill="none"
                                stroke="currentColor"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                stroke-width="1.5"
                                d="M9 12.75L11.25 15L15 9.75M21 12c0 1.268-.63 2.39-1.593 3.068a3.75 3.75 0 0 1-1.043 3.296a3.75 3.75 0 0 1-3.296 1.043A3.75 3.75 0 0 1 12 21c-1.268 0-2.39-.63-3.068-1.593a3.75 3.75 0 0 1-3.296-1.043a3.75 3.75 0 0 1-1.043-3.296A3.75 3.75 0 0 1 3 12c0-1.268.63-2.39 1.593-3.068a3.75 3.75 0 0 1 1.043-3.296a3.75 3.75 0 0 1 3.296-1.043A3.75 3.75 0 0 1 12 3c1.268 0 2.39.63 3.068 1.593a3.75 3.75 0 0 1 3.296 1.043a3.75 3.75 0 0 1 1.043 3.296A3.75 3.75 0 0 1 21 12"
                            ></path></svg
                        >
                    </div>
                    <h3 class="font-bold text-dark-800 mb-2">
                        10-Year Warranty
                    </h3>
                    <p class="text-sm text-dark-600">
                        We stand behind our work with comprehensive warranties.
                    </p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-sm text-center">
                    <div
                        class="w-12 h-12 bg-gold-100 text-gold-600 rounded-full flex items-center justify-center mx-auto mb-4"
                    >
                        <svg class="w-6 h-6"
                            ><path
                                fill="currentColor"
                                fill-rule="evenodd"
                                d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006l5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527l1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354L7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273l-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434z"
                                clip-rule="evenodd"></path></svg
                        >
                    </div>
                    <h3 class="font-bold text-dark-800 mb-2">5-Star Rated</h3>
                    <p class="text-sm text-dark-600">
                        Over {siteConfig.trustSignals.reviewCount} 5-star reviews
                        from satisfied customers.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Reviews -->
    <ReviewsCarousel title={`What Our ${service.title} Customers Say`} />

    <!-- Related Services -->
    <ServicesGrid title="Other Services We Offer" services={relatedServices} />

    <!-- Service Areas Link -->
    <section class="py-12 bg-white border-t border-gray-100">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-2xl font-bold text-dark-700 mb-4">
                Serving Northern New Jersey
            </h2>
            <p class="text-dark-600 mb-6 max-w-2xl mx-auto">
                Our licensed technicians are stationed throughout Bergen, Essex,
                Hudson, Morris, and Passaic counties for fast response times.
            </p>
            <Button variant="outline" href="/service-areas">
                <svg class="w-5 h-5 mr-2"
                    ><g
                        fill="none"
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="1.5"
                        ><path d="M15 10.5a3 3 0 1 1-6 0a3 3 0 0 1 6 0"
                        ></path><path
                            d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0"
                        ></path></g
                    ></svg
                >
                View Our Service Areas
            </Button>
        </div>
    </section>

    <!-- Final CTA -->
    <FinalCTA
        title={`Need ${service.title}?`}
        subtitle="Our licensed technicians are ready to help. Call now for same-day service."
    />

    <Footer />
</BaseLayout>
