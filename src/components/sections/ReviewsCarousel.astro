---
import ReviewsCarouselReact from "@components/ui/ReviewsCarousel";
import { reviews } from "@data/reviews";
import { siteConfig } from "@config/site.config";

import { generateReviewSchema } from "@utils/schema";
import { Icon } from "astro-icon/components";

interface Props {
    title?: string;
    subtitle?: string;
    className?: string;
}

const {
    title = "What Our Customers Say",
    subtitle = `Rated 5.0 Stars by over ${siteConfig.trustSignals.reviewCount}+ satisfied customers in Northern NJ`,
    className,
} = Astro.props;

const reviewSchemas = reviews.map((review) =>
    generateReviewSchema({
        author: review.author,
        datePublished: review.date,
        reviewBody: review.text,
        reviewRating: review.rating,
    }),
);
---

<section class={`py-16 bg-white ${className || ""}`}>
    {
        reviewSchemas.map((schema) => (
            <script
                type="application/ld+json"
                set:html={JSON.stringify(schema)}
            />
        ))
    }
    <div class="container mx-auto px-4">
        <div class="text-center max-w-3xl mx-auto mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-dark-700 mb-4">
                {title}
            </h2>
            <p class="text-lg text-dark-600">
                {subtitle}
            </p>
        </div>

        <ReviewsCarouselReact client:load reviews={reviews} />

        <div class="text-center mt-12">
            <a
                href="/reviews"
                class="inline-flex items-center justify-center px-8 py-3 bg-gold-500 text-dark-900 font-bold rounded-lg hover:bg-gold-600 hover:text-white transition-all shadow-md hover:shadow-lg group"
            >
                <Icon name="heroicons:star-solid" class="w-5 h-5 mr-2" />
                View All Reviews
            </a>
        </div>
    </div>
</section>
